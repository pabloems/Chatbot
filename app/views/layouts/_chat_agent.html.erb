<div data-controller="chat-agent" data-turbo-permanent="true" class="z-50">

  <button data-action="click->chat-agent#toggleChat" style="cursor: pointer;" class="fixed bottom-5 right-5 bg-blue-500 hover:bg-blue-600 text-white rounded-full w-14 h-14 flex items-center justify-center shadow-lg transition-transform hover:scale-105 focus:outline-none">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
    </svg>
  </button>

  <div data-chat-agent-target="interface" class="hidden flex-col fixed bottom-24 right-5 w-80 h-96 md:w-96 bg-white rounded-lg shadow-xl z-50 overflow-hidden">
    <div class="bg-blue-500 text-white px-4 py-3 flex justify-between items-center">
      <span class="font-medium">Chat AI Agent</span>
      <button data-action="click->chat-agent#toggleChat" class="text-white focus:outline-none">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>

    <div data-chat-agent-target="messages" class="flex-1 h-[calc(100%-3rem)] overflow-y-auto p-4 space-y-2" style="overflow-y: auto;overflow-x: hidden;">
      <!-- messages will be added here dynamically -->
    </div>

    <div class="border-t border-gray-200 p-3 flex items-center space-x-3" style="margin-top: auto;">
      <input
        data-chat-agent-target="input"
        data-action="keydown->chat-agent#handleKeydown"
        type="text"
        placeholder="CuÃ©ntanos en que te podemos ayudar..."
        class="flex-grow px-4 py-2 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent">
      <button
        data-action="click->chat-agent#sendMessage"
        class="bg-blue-500 hover:bg-blue-600 text-white rounded-full w-10 h-10 flex items-center justify-center flex-shrink-0 focus:outline-none">
        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="22" y1="2" x2="11" y2="13"></line>
          <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
        </svg>
      </button>
    </div>
  </div>
</div>